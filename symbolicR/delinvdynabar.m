function [ delta ] = delinvdynabar( d, l, m, In )

% extern double **d,**l,*m,**In;

% Barycentric Masses  

mb1 = m(1)+m(2)+m(3)+m(4)+m(5)+m(6);
mb2 = m(2)+m(3)+m(4)+m(5)+m(6);
mb3 = m(3)+m(4)+m(5)+m(6);
mb4 = m(4)+m(5)+m(6);
mb5 = m(5)+m(6);
mb6 = m(6);
 
% Barycentric Vectors  

b11 = m(1)*l(1,1)+mb2*d(1,2);
b12 = m(1)*l(2,1)+mb2*d(2,2);
b13 = m(1)*l(3,1)+mb2*d(3,2);
b21 = m(2)*l(1,2);
b22 = m(2)*l(2,2);
b23 = m(2)*l(3,2);
b31 = m(3)*l(1,3);
b32 = m(3)*l(2,3);
b33 = m(3)*l(3,3)+mb4*d(3,4);
b41 = m(4)*l(1,4);
b42 = m(4)*l(2,4);
b43 = m(4)*l(3,4)+mb5*d(3,5);
b51 = m(5)*l(1,5);
b52 = m(5)*l(2,5);
b53 = m(5)*l(3,5);
b61 = m(6)*l(1,6);
b62 = m(6)*l(2,6);
b63 = m(6)*l(3,6);
 
% Barycentric Tensors  

K111 = In(1,1)+m(1)*l(2,1)*l(2,1)+m(1)*l(3,1)*l(3,1)+mb2*d(2,2)*d(2,2)+mb2*d(3,2)*d(3,2);
K112 = In(2,1)-m(1)*l(1,1)*l(2,1)-mb2*d(1,2)*d(2,2);
K113 = In(3,1)-m(1)*l(1,1)*l(3,1)-mb2*d(1,2)*d(3,2);
K122 = In(5,1)+m(1)*l(1,1)*l(1,1)+m(1)*l(3,1)*l(3,1)+mb2*d(1,2)*d(1,2)+mb2*d(3,2)*d(3,2);
K123 = In(6,1)-m(1)*l(2,1)*l(3,1)-mb2*d(2,2)*d(3,2);
K133 = In(9,1)+m(1)*l(1,1)*l(1,1)+m(1)*l(2,1)*l(2,1)+mb2*d(1,2)*d(1,2)+mb2*d(2,2)*d(2,2);
K211 = In(1,2)+m(2)*l(2,2)*l(2,2)+m(2)*l(3,2)*l(3,2);
K212 = In(2,2)-m(2)*l(1,2)*l(2,2);
K213 = In(3,2)-m(2)*l(1,2)*l(3,2);
K222 = In(5,2)+m(2)*l(1,2)*l(1,2)+m(2)*l(3,2)*l(3,2);
K223 = In(6,2)-m(2)*l(2,2)*l(3,2);
K233 = In(9,2)+m(2)*l(1,2)*l(1,2)+m(2)*l(2,2)*l(2,2);
K311 = In(1,3)+m(3)*l(2,3)*l(2,3)+m(3)*l(3,3)*l(3,3)+mb4*d(3,4)*d(3,4);
K312 = In(2,3)-m(3)*l(1,3)*l(2,3);
K313 = In(3,3)-m(3)*l(1,3)*l(3,3);
K322 = In(5,3)+m(3)*l(1,3)*l(1,3)+m(3)*l(3,3)*l(3,3)+mb4*d(3,4)*d(3,4);
K323 = In(6,3)-m(3)*l(2,3)*l(3,3);
K333 = In(9,3)+m(3)*l(1,3)*l(1,3)+m(3)*l(2,3)*l(2,3);
K411 = In(1,4)+m(4)*l(2,4)*l(2,4)+m(4)*l(3,4)*l(3,4)+mb5*d(3,5)*d(3,5);
K412 = In(2,4)-m(4)*l(1,4)*l(2,4);
K413 = In(3,4)-m(4)*l(1,4)*l(3,4);
K422 = In(5,4)+m(4)*l(1,4)*l(1,4)+m(4)*l(3,4)*l(3,4)+mb5*d(3,5)*d(3,5);
K423 = In(6,4)-m(4)*l(2,4)*l(3,4);
K433 = In(9,4)+m(4)*l(1,4)*l(1,4)+m(4)*l(2,4)*l(2,4);
K511 = In(1,5)+m(5)*l(2,5)*l(2,5)+m(5)*l(3,5)*l(3,5);
K512 = In(2,5)-m(5)*l(1,5)*l(2,5);
K513 = In(3,5)-m(5)*l(1,5)*l(3,5);
K522 = In(5,5)+m(5)*l(1,5)*l(1,5)+m(5)*l(3,5)*l(3,5);
K523 = In(6,5)-m(5)*l(2,5)*l(3,5);
K533 = In(9,5)+m(5)*l(1,5)*l(1,5)+m(5)*l(2,5)*l(2,5);
K611 = In(1,6)+m(6)*l(2,6)*l(2,6)+m(6)*l(3,6)*l(3,6);
K612 = In(2,6)-m(6)*l(1,6)*l(2,6);
K613 = In(3,6)-m(6)*l(1,6)*l(3,6);
K622 = In(5,6)+m(6)*l(1,6)*l(1,6)+m(6)*l(3,6)*l(3,6);
K623 = In(6,6)-m(6)*l(2,6)*l(3,6);
K633 = In(9,6)+m(6)*l(1,6)*l(1,6)+m(6)*l(2,6)*l(2,6);
 
% Barycentric Tensors: elements Ks, Kd  

Ks6 = 0.500*(K622+K633);
Kd6 = 0.500*(K622-K633);
Ks5 = 0.500*(K511+K533+Ks6);
Kd5 = 0.500*(-K511+K533+Ks6);
Ks4 = 0.500*(K411+K433+2.000*Ks5);
Kd4 = 0.500*(-K411+K433);
Ks3 = 0.500*(K311+K333+2.000*Ks4);
Kd3 = 0.500*(-K311+K333);
Ks2 = 0.500*(K211+K222+Ks3);
Kd2 = 0.500*(K211-K222+Ks3);
Kd1 = 0.500*(K122-K133+Ks2+2.000*b23*d(3,2));
 
% Reduced Barycentric Vectors  

br13 = b13+b23;
br22 = b22+b32+b42+b52;
br51 = b51+b61;
 
% Reduced Barycentric Tensors  

Kr111 = K111+Ks2+2.000*b23*d(3,2);
Kr113 = K113-b23*d(1,2);
Kr123 = K123-b23*d(2,2);
Kr233 = K233+Ks3;
Kr323 = K323-b42*d(3,4)-b52*d(3,4);
Kr423 = K423-b52*d(3,5);
Kr522 = K522+Ks6;
 
% Definition of Minimal Set of Dynamical Paramaters 

delta(1) = b12;
delta(2) = br13;
delta(3) = Kr111;
delta(4) = b21;
delta(5) = br22;
delta(6) = Kd2;
delta(7) = K212;
delta(8) = K213;
delta(9) = K223;
delta(10) = Kr233;
delta(11) = b31;
delta(12) = b33;
delta(13) = K312;
delta(14) = K313;
delta(15) = K322;
delta(16) = Kr323;
delta(17) = Kd3;
delta(18) = b41;
delta(19) = b43;
delta(20) = K412;
delta(21) = K413;
delta(22) = K422;
delta(23) = Kr423;
delta(24) = Kd4;
delta(25) = br51;
delta(26) = b53;
delta(27) = K512;
delta(28) = K513;
delta(29) = Kr522;
delta(30) = K523;
delta(31) = Kd5;
delta(32) = b62;
delta(33) = b63;
delta(34) = K611;
delta(35) = K612;
delta(36) = K613;
delta(37) = Kd6;
delta(38) = K623;

end
